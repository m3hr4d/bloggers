{% extends "base.html" %}

{% block title %}ایجاد برنامه سفر جدید{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/sections/create-plan.css') }}">
<link rel="stylesheet" href="https://unpkg.com/persian-datepicker@1.2.0/dist/css/persian-datepicker.min.css">
{% endblock %}

{% block content %}
<div class="create-plan-container">
    <!-- Progress Bar -->
    <div class="progress-wrapper">
        <div class="progress-percentage">0%</div>
        <div class="progress">
            <div class="progress-bar" role="progressbar" style="width: 0%"></div>
        </div>
    </div>

    <!-- Steps Navigation -->
    <div class="steps-nav">
        <div class="step-item active">
            <div class="step-number">1</div>
            <p class="step-title">اطلاعات اصلی</p>
        </div>
        <div class="step-item">
            <div class="step-number">2</div>
            <p class="step-title">زمان‌بندی</p>
        </div>
        <div class="step-item">
            <div class="step-number">3</div>
            <p class="step-title">خدمات</p>
        </div>
        <div class="step-item">
            <div class="step-number">4</div>
            <p class="step-title">جزئیات تکمیلی</p>
        </div>
    </div>

    <!-- Form -->
    <form id="createPlanForm" method="POST" class="create-plan-form">
        <!-- Step 1: Basic Info -->
        <div class="form-step active">
            <div class="form-card">
                <h3><i class="bi bi-geo-alt"></i> اطلاعات اصلی سفر</h3>
                <div class="form-group">
                    <label class="form-label">مقصد</label>
                    <input type="text" name="destination" class="form-control" placeholder="مقصد سفر خود را وارد کنید" required>
                </div>
                <div class="form-group">
                    <label class="form-label">موقعیت دقیق</label>
                    <input type="text" name="location" class="form-control" placeholder="موقعیت دقیق را وارد کنید" required>
                </div>
            </div>
            <div class="form-navigation">
                <div></div>
                <button type="button" class="btn btn-primary btn-next">
                    مرحله بعد
                    <i class="bi bi-arrow-left"></i>
                </button>
            </div>
        </div>

        <!-- Step 2: Timing -->
        <div class="form-step">
            <div class="form-card">
                <h3><i class="bi bi-calendar3"></i> زمان‌بندی سفر</h3>
                <div class="form-group">
                    <label class="form-label">تاریخ شروع</label>
                    <input type="text" name="start_date" class="form-control persian-date" placeholder="تاریخ شروع را انتخاب کنید" required>
                </div>
                <div class="form-group">
                    <label class="form-label">تاریخ پایان</label>
                    <input type="text" name="end_date" class="form-control persian-date" placeholder="تاریخ پایان را انتخاب کنید" required>
                </div>
                <div class="form-group">
                    <label class="form-label">ساعت حضور</label>
                    <input type="text" name="time" class="form-control" placeholder="مثال: ۱۴:۰۰ تا ۱۸:۰۰">
                </div>
            </div>
            <div class="form-navigation">
                <button type="button" class="btn btn-secondary btn-prev">
                    <i class="bi bi-arrow-right"></i>
                    مرحله قبل
                </button>
                <button type="button" class="btn btn-primary btn-next">
                    مرحله بعد
                    <i class="bi bi-arrow-left"></i>
                </button>
            </div>
        </div>

        <!-- Step 3: Services -->
        <div class="form-step">
            <div class="form-card">
                <h3><i class="bi bi-list-check"></i> خدمات مورد نیاز</h3>
                <div class="services-grid">
                    <div class="service-option">
                        <input type="checkbox" name="services_requested" value="accommodation" id="service_accommodation">
                        <label for="service_accommodation">
                            <i class="bi bi-house"></i>
                            <span>اقامت</span>
                        </label>
                    </div>
                    <div class="service-option">
                        <input type="checkbox" name="services_requested" value="food" id="service_food">
                        <label for="service_food">
                            <i class="bi bi-cup-hot"></i>
                            <span>غذا و نوشیدنی</span>
                        </label>
                    </div>
                    <div class="service-option">
                        <input type="checkbox" name="services_requested" value="activities" id="service_activities">
                        <label for="service_activities">
                            <i class="bi bi-bicycle"></i>
                            <span>تفریحات و فعالیت‌ها</span>
                        </label>
                    </div>
                    <div class="service-option">
                        <input type="checkbox" name="services_requested" value="transportation" id="service_transportation">
                        <label for="service_transportation">
                            <i class="bi bi-car-front"></i>
                            <span>حمل و نقل</span>
                        </label>
                    </div>
                    <div class="service-option">
                        <input type="checkbox" name="services_requested" value="guide" id="service_guide">
                        <label for="service_guide">
                            <i class="bi bi-person-badge"></i>
                            <span>راهنمای محلی</span>
                        </label>
                    </div>
                    <div class="service-option">
                        <input type="checkbox" name="services_requested" value="photography" id="service_photography">
                        <label for="service_photography">
                            <i class="bi bi-camera"></i>
                            <span>عکاسی و فیلمبرداری</span>
                        </label>
                    </div>
                    <div class="service-option">
                        <input type="checkbox" name="services_requested" value="equipment" id="service_equipment">
                        <label for="service_equipment">
                            <i class="bi bi-tools"></i>
                            <span>تجهیزات و وسایل</span>
                        </label>
                    </div>
                    <div class="service-option">
                        <input type="checkbox" name="services_requested" value="other" id="service_other">
                        <label for="service_other">
                            <i class="bi bi-three-dots"></i>
                            <span>سایر خدمات</span>
                        </label>
                    </div>
                </div>
            </div>
            <div class="form-navigation">
                <button type="button" class="btn btn-secondary btn-prev">
                    <i class="bi bi-arrow-right"></i>
                    مرحله قبل
                </button>
                <button type="button" class="btn btn-primary btn-next">
                    مرحله بعد
                    <i class="bi bi-arrow-left"></i>
                </button>
            </div>
        </div>

        <!-- Step 4: Additional Details -->
        <div class="form-step">
            <div class="form-card">
                <h3><i class="bi bi-card-text"></i> جزئیات تکمیلی</h3>
                <div class="form-group">
                    <label class="form-label">موضوعات مورد علاقه برای محتوا</label>
                    <textarea name="topics_of_interest" class="form-control" rows="4" 
                        placeholder="مثال: معرفی جاذبه‌های گردشگری، تجربه اقامت، معرفی رستوران‌ها و..." required></textarea>
                </div>
            </div>
            <div class="form-navigation">
                <button type="button" class="btn btn-secondary btn-prev">
                    <i class="bi bi-arrow-right"></i>
                    مرحله قبل
                </button>
                <button type="submit" class="btn btn-primary">
                    ثبت برنامه
                    <i class="bi bi-check-lg"></i>
                </button>
            </div>
        </div>
    </form>
</div>
{% endblock %}

{% block extra_js %}
<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- Persian Date -->
<script src="https://unpkg.com/persian-date@1.1.0/dist/persian-date.min.js"></script>
<!-- Persian Datepicker -->
<script src="https://unpkg.com/persian-datepicker@1.2.0/dist/js/persian-datepicker.min.js"></script>
<!-- Custom JS -->
<script src="{{ url_for('static', filename='js/createPlan.js') }}"></script>

<script>
    // Initialize Persian Datepicker
    $('.persian-date').persianDatepicker({
        format: 'YYYY/MM/DD',
        autoClose: true,
        initialValue: false,
        persianDigit: true,
        observer: true,
        calendar: {
            persian: {
                locale: 'fa',
                showHint: true,
                leapYearMode: 'algorithmic'
            }
        },
        onSelect: function(unix) {
            const input = $(this.model.inputElement);
            const date = new persianDate(unix);
            input.val(date.format('YYYY/MM/DD'));
            input.trigger('change');
            input.attr('data-gdate', new Date(unix).toISOString().split('T')[0]);
        }
    });
</script>
{% endblock %}
